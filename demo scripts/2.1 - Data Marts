USE ROLE GUIDEWIRE_ADMIN;
CREATE SCHEMA GUIDEWIRE_CDA.CONSUMPTION;

CREATE VIEW GUIDEWIRE_CDA.CONSUMPTION.BC_CHARGEPT_NM_L10N_VW AS
    SELECT ID, LANGUAGE,OWNER,PUBLICID,VALUE,NEW_COLUMN
    FROM "GUIDEWIRE_CDA"."RAW"."BC_CHARGEPT_NM_L10N"
    WHERE GWCBI___TX_ID = (SELECT MAX(GWCBI___TX_ID) FROM "GUIDEWIRE_CDA"."RAW"."BC_CHARGEPT_NM_L10N")
;

CREATE VIEW GUIDEWIRE_CDA.CONSUMPTION.BC_TACCOUNTPATTERN_VW AS
    SELECT ID, PUBLICID,RETIRED,SUBTYPE,SUFFIX,TACCOUNTLAZYLOADED,TACCOUNTNAME,TACCOUNTOWNERPATTERNID,TACCOUNTTYPE,UPDATETIME,UPDATEUSERID
    FROM "GUIDEWIRE_CDA"."RAW"."BC_TACCOUNTPATTERN"
    WHERE GWCBI___TX_ID = (SELECT MAX(GWCBI___TX_ID) FROM "GUIDEWIRE_CDA"."RAW"."BC_CHARGEPT_NM_L10N")
;

SELECT * FROM GUIDEWIRE_CDA.CONSUMPTION.BC_CHARGEPT_NM_L10N_VW;
SELECT * FROM GUIDEWIRE_CDA.CONSUMPTION.BC_TACCOUNTPATTERN_VW;